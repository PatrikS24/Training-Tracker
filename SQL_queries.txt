PRAGMA foreign_keys = ON;

-- create workout table
CREATE TABLE IF NOT EXISTS workout(
    workoutID INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    start_time DATETIME NOT NULL,
    duration_minutes INTEGER
);

-- create movement table
CREATE TABLE IF NOT EXISTS movements(
    movementID INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL UNIQUE
);

-- create exercise table
CREATE TABLE IF NOT EXISTS exercise(
    exerciseID INTEGER PRIMARY KEY AUTOINCREMENT,
    workoutID INTEGER NOT NULL,
    FOREIGN KEY (workoutID) REFERENCES workout (workoutID)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    movementID INTEGER NOT NULL,
    FOREIGN KEY (movementID) REFERENCES movement (movementID)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    notes TEXT,
    order_index INTEGER
);

-- create exercise_set table
CREATE TABLE IF NOT EXISTS exercise_set(
    exercise_setID INTEGER PRIMARY KEY AUTOINCREMENT,
    exerciseID INTEGER NOT NULL,
    FOREIGN KEY (exerciseID) REFERENCES exercise (exerciseID)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    weight REAL NOT NULL,
    reps INTEGER NOT NULL,
    order_index INTEGER,
    is_warmup BOOLEAN NOT NULL DEFAULT 0
);